/*! 2024-11-03 */
Ufo.define(function(){var a=$('<canvas style="display:none;"></canvas>').get(0),n=a.getContext("2d");return{getBase64Image:function(t,h,i,e){Size.constraint(t,h,i);var d,g,h=t.width,i=t.height,h=Type.isNumber(h)&&Type.isNumber(i)?(d=h,i):(g=.2,Type.isNumber(h)?g=h>t.width?1:h/t.width:Type.isNumber(i)&&(g=i>t.height?1:i/t.height),d=t.width*g,t.height*g);return a.width=d,a.height=h,n.drawImage(t,0,0,d,h),{value:a.toDataURL(e),width:d,height:h}},zoom:function(h,i,e,d,g,a){var t,n,r=this,a=a||$.Deferred();return Ufo.isString(h)?(n=new Image,d=d||"image/png",n.onload=function(){var t=r.getBase64Image(n,i,e,d);g&&g.call(r,base64.toFile(t.value,d),t.value,t),a.resolve(base64.toFile(t.value,d),t.value,t)},n.src=h):((t=new FileReader).onload=function(t){d=h.type,h=t.target.result,r.zoom(h,i,e,d,g,a)},t.readAsDataURL(h)),a},getSize:function(t,g,a){Type.isString(t)||(t=URL.createObjectURL(t));var n=this,h=new Image,r=$.Deferred();return Ufo.isFunction(g)&&(a=g,g=void 0),h.onload=function(){var t,h,i,e={width:this.width,height:this.height},d=e;g&&(h=/(\d*(\.\d+)?)([^\d]+)$/,t=g.width&&g.width.match(h),h=g.height&&g.height.match(h),i=t?t[3]:h?h[3]:"",t&&(g.width=t[1]),h&&(g.height=h[1]),(d=n.constraint(g,e)).width=d.width+i,d.height=d.height+i),a&&a(d,this),r.resolve(d,this)},h.src=t,r},constraint:function(t,h){return t.width&&t.width>h.width&&(h.height=t.width/h.width*h.height,h.width=t.width),t.width&&t.width<h.width&&(h.height=t.width/h.width*h.height,h.width=t.width),t.height&&t.height>h.height&&(h.width=t.height/h.height*h.width,h.height=t.height),t.height&&t.height<h.height&&(h.width=t.height/h.height*h.width,h.height=t.height),h}}});